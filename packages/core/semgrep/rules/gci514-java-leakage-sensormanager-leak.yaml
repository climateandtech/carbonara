rules:
  - id: gci514-java-leakage-sensormanager-leak
    languages:
      - java
    severity: WARNING
    message: Release SensorManager resources to avoid battery drain. Ensure every
      registerListener() call has a corresponding unregisterListener().
    patterns:
      - pattern: $SENSOR_MANAGER.registerListener($LISTENER, $SENSOR, $DELAY);
      - pattern-not-inside: |
          $SENSOR_MANAGER.registerListener($LISTENER, $SENSOR, $DELAY);
          ...
          $SENSOR_MANAGER.unregisterListener($LISTENER);
